const i="https://api.github.com",u=()=>{const r={Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"},t=localStorage.getItem("gh-token");return t&&(r.Authorization=`Bearer ${t}`),r},l=r=>new Promise(t=>setTimeout(t,r)),n=async(r,t=3,s=1e3)=>{try{const e=await fetch(r,{headers:u()});if(e.status===403){const a=e.headers.get("x-ratelimit-remaining"),c=e.headers.get("x-ratelimit-reset");if(a==="0"){const o=new Date(parseInt(c)*1e3);throw new Error(`Rate limit exceeded. Resets at ${o.toLocaleTimeString()}`)}throw new Error("Forbidden: Check your access token")}if(e.status===404)throw new Error("Resource not found");if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);return{data:await e.json(),rateLimit:{remaining:parseInt(e.headers.get("x-ratelimit-remaining")||"0"),limit:parseInt(e.headers.get("x-ratelimit-limit")||"0"),reset:parseInt(e.headers.get("x-ratelimit-reset")||"0")}}}catch(e){if(t>0&&!e.message.includes("Rate limit")){const a=Math.random()*100;return await l(s+a),n(r,t-1,s*2)}throw e}},m=async(r,t={})=>{const{language:s="",minStars:e=0,sort:a="stars",order:c="desc",page:o=1,perPage:g=30}=t;let d=r;s&&(d+=`+language:${encodeURIComponent(s)}`),e>0&&(d+=`+stars:>=${e}`);const p=`${i}/search/repositories?q=${encodeURIComponent(d)}&sort=${a}&order=${c}&page=${o}&per_page=${g}`;return n(p)},$=async(r={})=>{const{language:t="",page:s=1,perPage:e=30}=r,a=new Date;a.setDate(a.getDate()-7);let o=`created:>${a.toISOString().split("T")[0]}`;t&&(o+=`+language:${encodeURIComponent(t)}`);const g=`${i}/search/repositories?q=${encodeURIComponent(o)}&sort=stars&order=desc&page=${s}&per_page=${e}`;return n(g)},h=async(r,t)=>{const s=`${i}/repos/${r}/${t}`;return n(s)},w=async(r,t)=>{try{const s=`${i}/repos/${r}/${t}/readme`,e=await n(s);if(e.data.content){const a=atob(e.data.content);return{...e,data:{...e.data,decodedContent:a}}}return e}catch(s){if(s.message.includes("not found"))return{data:null,rateLimit:null};throw s}},R=async(r,t)=>{const s=`${i}/repos/${r}/${t}/languages`;return n(s)},y=async(r,t,s=10)=>{const e=`${i}/repos/${r}/${t}/events?per_page=${s}`;return n(e)};export{w as a,R as b,y as c,$ as d,h as g,m as s};
